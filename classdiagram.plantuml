@startuml
skinparam classAttributeIconSize 0
' skinparam linetype ortho
skinparam nodesep 60
skinparam ranksep 70

skinparam groupInheritance 2 

title Board Game Cafe System Class Diagram 

' ==========================================
' PACKAGES (GROUPING)
' ==========================================

package "Management Core" {
    class BoardGameCafeSystem {
        - version : str
        + add_branch(cafe : BoardGameCafe)
        + aggregate_reports()
    }

    class BoardGameCafe {
        - cafe_id : str
        - name : str
        - location : str
        - BoardGames : List<BoardGame>
        - Lobbies : List<Lobby>
        + log_event(log : SystemLog)
    }

    abstract class Lobby {
        - lobby_id : str
        - play_tables : List<PlayTable>
        - type : str
        - fee: int
        + get_available_tables()
    }

    class NormalLobby {
        - fee : 0
    }

    class VIPLobby {
        - fee : 100
    }

    class PlayTable {
        - table_id : str
        - capacity : int
        - status : str
        + assign_customer()
        + clear_table()
    }
}

package "Person & Auth" {
    abstract class Person {
        - user_id : str
        - name : str
        - contact : str
    }

    class Owner {
        + view_total_revenue_report(period : str) : Report
        + access_audit_logs() : List<AuditLog>
    }

    class Manager {
        + approve_void_bill(order_id : str) : bool
        + add_staff(staff : Staff) : void
        + remove_staff(staff_id : str) : void
        + override_inventory_stock(item_id : str, qty : int) : void
        + view_daily_sales() : FinancialLog
    }

    class Staff {
        - staff_id : str
        - salary : float
        + take_order(order : Order) : void
        + serve_item(item : MenuItem) : void
    }

    class Reception {
        + assign_table()
        + check_booking_status(booking_id : str) : Reservation
        + assign_walk_in_customer(table : PlayTable) : bool
        + register_new_member(customer : Customer) : Member
        + handle_check_in(reservation : Reservation) : void
    }

    class Customer {
        - customer_id : str
        - total_spent : float
        - Birthdate : date
        - StudentID : str
    }

    class Member {
        - member_id : str
        - points : int
        - discount : float
        - max_booking_duration : int
        - max_active_booking_quota : int
        - max_advance_booking_days : int
        + get_discount(): float
        + get_max_booking_duration() :int
        + get_max_active_booking_quota() :int
        + get_max_advance_booking_days() :int
    }

    class MemberSilver {
        - discount : 5%
        + get_discount(): float
    }
    class MemberGold {
        - discount : 10%
        + get_discount(): float
    }
    class MemberPlatinum {
        - discount : 15%
        + get_discount(): float
    }
    
    class NonMember {
    }

    abstract class Authentication {
        # session_token : str
        # timeout_duration : int
        + {abstract} validate_credentials() : bool
        + encrypt_password(password : str) : str
        + logout() : void
        + validate_credentials(username : str, password : str) : bool
    }

    class Login{
        + validate_credentials(username : str, password : str) : bool
        + reset_password_request(email : str) : void
    }
    
    class Register{
        + create_new_account(data : dict) : Customer
    }
}
package "Inventory & Menu" {
    class MenuList {
        - items : List<MenuItem>
        + item_add()
        + item_remove()
    }

    abstract class MenuItem {
        - item_id : str
        - name : str
        - price : float
        + get_price(): float
    }

    class Food {
        + get_price(): float
    }

    class Drink {
        + get_price(): float
    }

    class BoardGame {
        - game_id : str
        - game_name : str
        - genre : str
        - status : str
        - price : float
        + update_condition()
        + get_price(): float
    }
}

package "Operations (Order & Resv)" {
    class OrderSystem {
        - orders : List<Order>
        + create_order()
        + check_out_order()
    }

    class Order {
        - order_id : str
        - status : str
        - net_amount : float
        - play_table : PlayTable
        + calculate_total()
        + check_all_served()
    }

    class Payment {
        - payment_id : str
        - amount : float
        + process_payment()
    }

    class Cash {}
    class Card {}
    class OnlinePayment {}

    class ReservationManager {
        - reservations : List<Reservation>
        + create_reservation()
        + check_availability()
        + confirm_reservation()
        + cancel_reservation()
    }

    class Reservation {
        - reservation_id : str
        - customer : Customer
        - date : date
        - start_time : time
        - end_time : time
        - play_table : PlayTable
        - pax: int
        - status : str
    }
}

package "Reporting Module" {
    abstract class SystemLog {
        - log_id : str
        - timestamp : datetime
        - recorded_by : str
        + get_report(): str
    }

    class FinancialLog {
        - amount : float
    }
    class ReservationLog {
        - reservation : Reservation
        - action : str
    }
    class InventoryLog {
        - item_id : str
    }
    class AuditLog {
        - action_type : str
    }
}

' ==========================================
' RELATIONSHIPS
' ==========================================

' --- 1. Main Structure Hierarchy ---
BoardGameCafeSystem "1" *--> "*" BoardGameCafe
BoardGameCafeSystem "1" *--> "*" Person
BoardGameCafeSystem "1" --> Authentication
BoardGameCafe "1" *--> "*" BoardGame
BoardGameCafe "1" *--> "*" Lobby
Lobby "1" *--> "*" PlayTable

' --- 2. Sub-Systems Connections ---
BoardGameCafe "1" --> "1" MenuList
BoardGameCafe "1" --> "1" OrderSystem
BoardGameCafe "1" --> "1" ReservationManager
BoardGameCafe "1" -r-> "*" SystemLog 

' --- 3. Inheritance Grouping (Person) ---

Person <|-- Owner
Person <|-- Manager
Person <|-- Staff
Staff <|-- Reception
Person <|-- Customer
Customer <|-- Member
Customer <|-- NonMember
Member <|-- MemberSilver
Member <|-- MemberGold
Member <|-- MemberPlatinum

' --- 4. Inheritance Grouping (Items) ---
MenuItem <|-- Food
MenuItem <|-- Drink
Lobby <|-- NormalLobby
Lobby <|-- VIPLobby
Authentication <|-- Login
Authentication <|-- Register
MenuList "1" o--> "*" MenuItem

' --- 5. Inheritance Grouping (Ops) ---
Payment <|-- Cash
Payment <|-- Card
Payment <|-- OnlinePayment

' --- 6. Inheritance Grouping (Logs) ---
SystemLog <|-- FinancialLog
SystemLog <|-- ReservationLog
SystemLog <|-- InventoryLog
SystemLog <|-- AuditLog

' --- 7. Operational Flow (Minimal Arrows) ---
OrderSystem "1" --> "*" Order
Order "1" --> "1" Payment
Order "*" <--> "1" PlayTable

ReservationManager "1" --> "*" Reservation

@enduml